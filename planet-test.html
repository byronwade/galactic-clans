<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üåç Planet Generator Test - Galactic Clans</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    
    <!-- Custom Styles -->
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        
        :root {
            --background: 0 0% 100%;
            --foreground: 222.2 84% 4.9%;
            --card: 0 0% 100%;
            --card-foreground: 222.2 84% 4.9%;
            --popover: 0 0% 100%;
            --popover-foreground: 222.2 84% 4.9%;
            --primary: 221.2 83.2% 53.3%;
            --primary-foreground: 210 40% 98%;
            --secondary: 210 40% 96%;
            --secondary-foreground: 222.2 84% 4.9%;
            --muted: 210 40% 96%;
            --muted-foreground: 215.4 16.3% 46.9%;
            --accent: 210 40% 96%;
            --accent-foreground: 222.2 84% 4.9%;
            --destructive: 0 84.2% 60.2%;
            --destructive-foreground: 210 40% 98%;
            --border: 214.3 31.8% 91.4%;
            --input: 214.3 31.8% 91.4%;
            --ring: 221.2 83.2% 53.3%;
            --radius: 0.5rem;
        }
        
        .dark {
            --background: 222.2 84% 4.9%;
            --foreground: 210 40% 98%;
            --card: 222.2 84% 4.9%;
            --card-foreground: 210 40% 98%;
            --popover: 222.2 84% 4.9%;
            --popover-foreground: 210 40% 98%;
            --primary: 217.2 91.2% 59.8%;
            --primary-foreground: 222.2 84% 4.9%;
            --secondary: 217.2 32.6% 17.5%;
            --secondary-foreground: 210 40% 98%;
            --muted: 217.2 32.6% 17.5%;
            --muted-foreground: 215 20.2% 65.1%;
            --accent: 217.2 32.6% 17.5%;
            --accent-foreground: 210 40% 98%;
            --destructive: 0 62.8% 30.6%;
            --destructive-foreground: 210 40% 98%;
            --border: 217.2 32.6% 17.5%;
            --input: 217.2 32.6% 17.5%;
            --ring: 224.3 76.3% 94.1%;
        }
        
        * {
            border-color: hsl(var(--border));
        }
        
        body {
            background-color: hsl(var(--background));
            color: hsl(var(--foreground));
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }
        
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius);
            font-weight: 500;
            transition: all 0.2s;
            cursor: pointer;
            border: 1px solid transparent;
            text-decoration: none;
            position: relative;
            overflow: hidden;
        }
        
        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-primary {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }
        
        .btn-primary:hover:not(:disabled) {
            background-color: hsl(var(--primary) / 0.9);
        }
        
        .btn-secondary {
            background-color: hsl(var(--secondary));
            color: hsl(var(--secondary-foreground));
            border-color: hsl(var(--border));
        }
        
        .btn-secondary:hover:not(:disabled) {
            background-color: hsl(var(--secondary) / 0.8);
        }
        
        .btn-destructive {
            background-color: hsl(var(--destructive));
            color: hsl(var(--destructive-foreground));
        }
        
        .btn-destructive:hover:not(:disabled) {
            background-color: hsl(var(--destructive) / 0.9);
        }
        
        .btn-sm {
            height: 2rem;
            padding: 0 0.75rem;
            font-size: 0.875rem;
        }
        
        .btn-md {
            height: 2.5rem;
            padding: 0 1rem;
        }
        
        .btn-lg {
            height: 3rem;
            padding: 0 1.5rem;
            font-size: 1.125rem;
        }
        
        .card {
            background-color: hsl(var(--card));
            border: 1px solid hsl(var(--border));
            border-radius: var(--radius);
            box-shadow: 0 1px 3px 0 rgb(0 0 0 / 0.1), 0 1px 2px -1px rgb(0 0 0 / 0.1);
        }
        
        .input {
            display: flex;
            height: 2.5rem;
            width: 100%;
            border-radius: var(--radius);
            border: 1px solid hsl(var(--border));
            background-color: hsl(var(--background));
            padding: 0 0.75rem;
            font-size: 0.875rem;
            transition: border-color 0.2s;
        }
        
        .input:focus {
            outline: none;
            border-color: hsl(var(--ring));
            box-shadow: 0 0 0 2px hsl(var(--ring) / 0.2);
        }
        
        .badge {
            display: inline-flex;
            align-items: center;
            border-radius: var(--radius);
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.125rem 0.5rem;
        }
        
        .badge-success {
            background-color: hsl(142.1 76.2% 36.3%);
            color: hsl(355.7 100% 97.3%);
        }
        
        .badge-warning {
            background-color: hsl(48 96% 53%);
            color: hsl(48 96% 10%);
        }
        
        .badge-error {
            background-color: hsl(var(--destructive));
            color: hsl(var(--destructive-foreground));
        }
        
        .badge-info {
            background-color: hsl(var(--primary));
            color: hsl(var(--primary-foreground));
        }
        
        /* Custom Scrollbar */
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-track {
            background: hsl(var(--muted));
            border-radius: 3px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: hsl(var(--muted-foreground));
            border-radius: 3px;
        }
        
        .custom-scrollbar::-webkit-scrollbar-thumb:hover {
            background: hsl(var(--muted-foreground) / 0.8);
        }
        
        /* Animation Classes */
        .pulse {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .bounce {
            animation: bounce 1s infinite;
        }
        
        @keyframes bounce {
            0%, 100% { transform: translateY(-25%); animation-timing-function: cubic-bezier(0.8, 0, 1, 1); }
            50% { transform: none; animation-timing-function: cubic-bezier(0, 0, 0.2, 1); }
        }
        
        /* Loading indicator */
        .loading {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 18px;
            z-index: 1000;
        }
        
        .loading::after {
            content: '';
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 2px solid hsl(var(--primary));
            border-radius: 50%;
            border-top-color: transparent;
            animation: spin 1s linear infinite;
            margin-left: 10px;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Status message */
        .status {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            background: hsl(var(--card));
            color: hsl(var(--card-foreground));
            padding: 12px 16px;
            border-radius: var(--radius);
            font-size: 14px;
            z-index: 10000;
            border: 1px solid hsl(var(--border));
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }
        
        .status.success { 
            border-color: hsl(142.1 76.2% 36.3%);
            background-color: hsl(142.1 76.2% 36.3% / 0.1);
        }
        
        .status.error { 
            border-color: hsl(var(--destructive));
            background-color: hsl(var(--destructive) / 0.1);
        }
        
        .status.warning { 
            border-color: hsl(48 96% 53%);
            background-color: hsl(48 96% 53% / 0.1);
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900">
    <!-- Header -->
    <header class="border-b border-slate-700 bg-slate-800/50 backdrop-blur-sm">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-lg flex items-center justify-center">
                        <i class="fas fa-globe text-white text-lg"></i>
                    </div>
                    <div>
                        <h1 class="text-xl font-bold text-white">Planet Generator Test</h1>
                        <p class="text-sm text-slate-400">Advanced 3D Planet Creation & Customization</p>
                    </div>
                </div>
                <div class="flex items-center gap-4">
                    <div class="flex items-center gap-2 text-sm text-slate-400">
                        <i class="fas fa-cube"></i>
                        <span>Three.js v0.158.0</span>
                    </div>
                    <button onclick="toggleTheme()" class="btn btn-secondary btn-sm">
                        <i class="fas fa-moon"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="relative h-screen">
        <!-- 3D Canvas -->
        <div id="three-container" class="absolute inset-0"></div>
        
        <!-- Control Panel -->
        <div class="absolute top-4 left-4 z-10">
            <div class="card p-6 w-80 max-h-[calc(100vh-2rem)] overflow-y-auto custom-scrollbar">
                <div class="flex items-center justify-between mb-6">
                    <h3 class="text-lg font-semibold">Planet Controls</h3>
                    <div class="flex items-center gap-2">
                        <span class="badge badge-info">Ready</span>
                    </div>
                </div>
                
                <!-- Planet Type -->
                <div class="space-y-2 mb-4">
                    <label class="text-sm font-medium">Planet Type</label>
                    <select id="planetType" class="input">
                        <option value="little">Little Planet</option>
                        <option value="enhanced">Enhanced Planet</option>
                        <option value="standard">Standard Planet</option>
                    </select>
                </div>
                
                <!-- Biome -->
                <div class="space-y-2 mb-4">
                    <label class="text-sm font-medium">Biome</label>
                    <select id="biome" class="input">
                        <option value="temperate">Temperate</option>
                        <option value="desert">Desert</option>
                        <option value="arctic">Arctic</option>
                        <option value="tropical">Tropical</option>
                        <option value="volcanic">Volcanic</option>
                        <option value="ocean">Ocean</option>
                        <option value="barren">Barren</option>
                    </select>
                </div>
                
                <!-- Detail Level -->
                <div class="space-y-2 mb-4">
                    <label class="text-sm font-medium">Detail Level</label>
                    <select id="detailLevel" class="input">
                        <option value="low">Low</option>
                        <option value="medium">Medium</option>
                        <option value="high">High</option>
                        <option value="ultra">Ultra</option>
                    </select>
                </div>
                
                <!-- Radius -->
                <div class="space-y-2 mb-4">
                    <label class="text-sm font-medium">Radius: <span id="radiusValue">2.0</span></label>
                    <input type="range" id="radius" min="0.5" max="5.0" step="0.1" value="2.0" class="w-full">
                </div>
                
                <!-- Seed -->
                <div class="space-y-2 mb-4">
                    <label class="text-sm font-medium">Seed</label>
                    <input type="number" id="seed" value="12345" class="input">
                </div>
                
                <!-- Features -->
                <div class="space-y-2 mb-4">
                    <label class="text-sm font-medium">Features</label>
                    <div class="space-y-2">
                        <label class="flex items-center gap-2">
                            <input type="checkbox" id="atmosphere" checked>
                            <span class="text-sm">Atmosphere</span>
                        </label>
                        <label class="flex items-center gap-2">
                            <input type="checkbox" id="rings">
                            <span class="text-sm">Rings</span>
                        </label>
                        <label class="flex items-center gap-2">
                            <input type="checkbox" id="moons">
                            <span class="text-sm">Moons</span>
                        </label>
                    </div>
                </div>
                
                <!-- Action Buttons -->
                <div class="space-y-2">
                    <button onclick="generatePlanet()" class="btn btn-primary w-full">
                        <i class="fas fa-magic mr-2"></i>Generate Planet
                    </button>
                    <div class="grid grid-cols-2 gap-2">
                        <button onclick="randomizePlanet()" class="btn btn-secondary">
                            <i class="fas fa-dice mr-1"></i>Randomize
                        </button>
                        <button onclick="clearPlanet()" class="btn btn-destructive">
                            <i class="fas fa-trash mr-1"></i>Clear
                        </button>
                    </div>
                </div>
                
                <!-- Keyboard Shortcuts -->
                <div class="mt-6 pt-4 border-t border-slate-700">
                    <h4 class="text-sm font-medium mb-2">Keyboard Shortcuts</h4>
                    <div class="text-xs text-slate-400 space-y-1">
                        <div><kbd class="bg-slate-700 px-1 rounded">G</kbd> Generate Planet</div>
                        <div><kbd class="bg-slate-700 px-1 rounded">R</kbd> Randomize</div>
                        <div><kbd class="bg-slate-700 px-1 rounded">C</kbd> Clear</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Camera Info -->
        <div class="absolute bottom-4 right-4 z-10">
            <div class="card p-4">
                <h4 class="text-sm font-medium mb-2">Camera Controls</h4>
                <div class="text-xs text-slate-400 space-y-1">
                    <div>üñ±Ô∏è Left Click + Drag: Rotate</div>
                    <div>üñ±Ô∏è Right Click + Drag: Pan</div>
                    <div>üñ±Ô∏è Scroll: Zoom</div>
                </div>
            </div>
        </div>
        
        <!-- Loading Indicator -->
        <div id="loading" class="loading hidden">
            Generating planet...
        </div>
        
        <!-- Status Message -->
        <div id="status" class="status hidden"></div>
    </main>

    <!-- Import Maps for Three.js -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.158.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.158.0/examples/jsm/"
        }
    }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        
        // Suppress console warnings
        const originalWarn = console.warn;
        console.warn = function(...args) {
            const message = args.join(' ');
            if (message.includes('onBeforeRender()') || 
                message.includes('onBuild()') || 
                message.includes('Multiple instances of Three.js')) {
                return;
            }
            originalWarn.apply(console, args);
        };
        
        // Global variables
        let scene, camera, renderer, controls;
        let currentPlanet = null;
        let clock = new THREE.Clock();
        
        // Initialize Three.js
        function initThreeJS() {
            console.log('üöÄ [PLANET] Initializing Three.js...');
            
            // Scene
            scene = new THREE.Scene();
            scene.background = new THREE.Color(0x0a0a0a);
            
            // Camera
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 0, 10);
            
            // Renderer
            renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFSoftShadowMap;
            
            const container = document.getElementById('three-container');
            container.appendChild(renderer.domElement);
            
            // Controls
            controls = new OrbitControls(camera, renderer.domElement);
            controls.enableDamping = true;
            controls.dampingFactor = 0.05;
            
            // Lighting
            setupLighting();
            
            // Event listeners
            window.addEventListener('resize', onWindowResize);
            document.addEventListener('keydown', onKeyDown);
            
            // Start animation loop
            animate();
            
            console.log('‚úÖ [PLANET] Three.js initialized successfully');
        }
        
        function setupLighting() {
            // Ambient light
            const ambientLight = new THREE.AmbientLight(0x404080, 0.6);
            scene.add(ambientLight);
            
            // Directional light (sun)
            const sunLight = new THREE.DirectionalLight(0xffeaa7, 2.0);
            sunLight.position.set(10, 10, 5);
            sunLight.castShadow = true;
            sunLight.shadow.mapSize.width = 2048;
            sunLight.shadow.mapSize.height = 2048;
            scene.add(sunLight);
            
            // Fill light
            const fillLight = new THREE.DirectionalLight(0x74b9ff, 0.8);
            fillLight.position.set(-10, 5, -5);
            scene.add(fillLight);
            
            // Rim light
            const rimLight = new THREE.DirectionalLight(0xffeaa7, 0.6);
            rimLight.position.set(0, -10, 0);
            scene.add(rimLight);
        }
        
        function generatePlanet() {
            if (!scene || !camera) {
                console.error('‚ùå [PLANET] Three.js not initialized');
                return;
            }
            
            showLoading('Generating planet...');
            
            try {
                // Clear existing planet
                if (currentPlanet) {
                    scene.remove(currentPlanet);
                    currentPlanet.geometry?.dispose();
                    currentPlanet.material?.dispose();
                }
                
                // Get parameters
                const planetType = document.getElementById('planetType').value;
                const biome = document.getElementById('biome').value;
                const detailLevel = document.getElementById('detailLevel').value;
                const radius = parseFloat(document.getElementById('radius').value);
                const seed = parseInt(document.getElementById('seed').value);
                const atmosphere = document.getElementById('atmosphere').checked;
                const rings = document.getElementById('rings').checked;
                const moons = document.getElementById('moons').checked;
                
                console.log('üåç [PLANET] Generating planet with parameters:', {
                    type: planetType,
                    biome,
                    detailLevel,
                    radius,
                    seed,
                    atmosphere,
                    rings,
                    moons
                });
                
                // Create planet geometry
                const geometry = new THREE.IcosahedronGeometry(radius, 3);
                const material = new THREE.MeshPhongMaterial({
                    color: getBiomeColor(biome),
                    shininess: 30,
                    specular: 0x444444
                });
                
                currentPlanet = new THREE.Mesh(geometry, material);
                currentPlanet.castShadow = true;
                currentPlanet.receiveShadow = true;
                
                // Add to scene
                scene.add(currentPlanet);
                
                // Add atmosphere if enabled
                if (atmosphere) {
                    const atmosphereGeometry = new THREE.SphereGeometry(radius * 1.1, 32, 32);
                    const atmosphereMaterial = new THREE.MeshPhongMaterial({
                        color: 0x87ceeb,
                        transparent: true,
                        opacity: 0.3,
                        side: THREE.BackSide
                    });
                    const atmosphereMesh = new THREE.Mesh(atmosphereGeometry, atmosphereMaterial);
                    currentPlanet.add(atmosphereMesh);
                }
                
                // Add rings if enabled
                if (rings) {
                    const ringGeometry = new THREE.RingGeometry(radius * 1.5, radius * 2.5, 32);
                    const ringMaterial = new THREE.MeshPhongMaterial({
                        color: 0x8b4513,
                        transparent: true,
                        opacity: 0.7,
                        side: THREE.DoubleSide
                    });
                    const ringMesh = new THREE.Mesh(ringGeometry, ringMaterial);
                    ringMesh.rotation.x = Math.PI / 2;
                    currentPlanet.add(ringMesh);
                }
                
                // Add moons if enabled
                if (moons) {
                    for (let i = 0; i < 2; i++) {
                        const moonGeometry = new THREE.SphereGeometry(radius * 0.2, 16, 16);
                        const moonMaterial = new THREE.MeshPhongMaterial({
                            color: 0x808080,
                            shininess: 10
                        });
                        const moon = new THREE.Mesh(moonGeometry, moonMaterial);
                        moon.position.set(
                            (Math.random() - 0.5) * radius * 4,
                            (Math.random() - 0.5) * radius * 4,
                            (Math.random() - 0.5) * radius * 4
                        );
                        currentPlanet.add(moon);
                    }
                }
                
                hideLoading();
                showStatus('Planet generated successfully!', 'success');
                
                console.log('‚úÖ [PLANET] Planet generated successfully');
                
            } catch (error) {
                console.error('‚ùå [PLANET] Error generating planet:', error);
                hideLoading();
                showStatus('Error generating planet: ' + error.message, 'error');
            }
        }
        
        function getBiomeColor(biome) {
            const colors = {
                temperate: 0x7cfc00,
                desert: 0xf4a460,
                arctic: 0xf0f8ff,
                tropical: 0x32cd32,
                volcanic: 0x8b0000,
                ocean: 0x1e90ff,
                barren: 0x696969
            };
            return colors[biome] || colors.temperate;
        }
        
        function randomizePlanet() {
            console.log('üé≤ [PLANET] Randomizing planet parameters...');
            
            // Randomize parameters
            document.getElementById('planetType').value = ['little', 'enhanced', 'standard'][Math.floor(Math.random() * 3)];
            document.getElementById('biome').value = ['temperate', 'desert', 'arctic', 'tropical', 'volcanic', 'ocean', 'barren'][Math.floor(Math.random() * 7)];
            document.getElementById('detailLevel').value = ['low', 'medium', 'high', 'ultra'][Math.floor(Math.random() * 4)];
            document.getElementById('radius').value = (Math.random() * 4.5 + 0.5).toFixed(1);
            document.getElementById('seed').value = Math.floor(Math.random() * 100000);
            document.getElementById('atmosphere').checked = Math.random() > 0.5;
            document.getElementById('rings').checked = Math.random() > 0.7;
            document.getElementById('moons').checked = Math.random() > 0.6;
            
            // Update radius display
            document.getElementById('radiusValue').textContent = document.getElementById('radius').value;
            
            // Generate new planet
            generatePlanet();
        }
        
        function clearPlanet() {
            console.log('üóëÔ∏è [PLANET] Clearing planet...');
            
            if (currentPlanet) {
                scene.remove(currentPlanet);
                currentPlanet.geometry?.dispose();
                currentPlanet.material?.dispose();
                currentPlanet = null;
            }
            
            showStatus('Planet cleared', 'info');
        }
        
        function animate() {
            requestAnimationFrame(animate);
            
            const elapsed = clock.getElapsedTime();
            
            // Rotate planet
            if (currentPlanet) {
                currentPlanet.rotation.y = elapsed * 0.2;
            }
            
            // Update controls
            if (controls) {
                controls.update();
            }
            
            // Render
            if (renderer && scene && camera) {
                renderer.render(scene, camera);
            }
        }
        
        function onWindowResize() {
            if (camera && renderer) {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            }
        }
        
        function onKeyDown(event) {
            switch(event.key.toLowerCase()) {
                case 'g':
                    generatePlanet();
                    break;
                case 'r':
                    randomizePlanet();
                    break;
                case 'c':
                    clearPlanet();
                    break;
            }
        }
        
        // UI Functions
        function showLoading(message) {
            const loading = document.getElementById('loading');
            loading.textContent = message;
            loading.classList.remove('hidden');
        }
        
        function hideLoading() {
            document.getElementById('loading').classList.add('hidden');
        }
        
        function showStatus(message, type = 'info') {
            const status = document.getElementById('status');
            status.textContent = message;
            status.className = `status ${type}`;
            status.classList.remove('hidden');
            
            setTimeout(() => {
                status.classList.add('hidden');
            }, 3000);
        }
        
        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
        }
        
        // Event listeners for controls
        document.getElementById('radius').addEventListener('input', (e) => {
            document.getElementById('radiusValue').textContent = e.target.value;
        });
        
        // Initialize
        initThreeJS();
        
        // Auto-generate initial planet
        setTimeout(() => {
            generatePlanet();
        }, 1000);
        
        // Expose functions globally for onclick handlers
        window.generatePlanet = generatePlanet;
        window.randomizePlanet = randomizePlanet;
        window.clearPlanet = clearPlanet;
        window.toggleTheme = toggleTheme;
    </script>
</body>
</html> 